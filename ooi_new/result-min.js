$_GET=[];var TryIndx=0;function getResultFileInfo(e){debug;var t=new XMLHttpRequest;t.open("GET",`${API}/Files/result/${e}`,!0),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status&&t.response&&(fileInfo=JSON.parse(t.response),debug,fileInfo)){fileInfo.resSize&&checkExistAndInvoke("ressize",(function(e){e.innerText=(fileInfo.resSize/1048576).toFixed(2)})),fileInfo.srcSize&&checkExistAndInvoke("srcsize",(function(e){e.innerText=(fileInfo.srcSize/1048576).toFixed(2)}));let t="payment.html";fileInfo.isPayed&&(t="download.html"),checkExistAndInvoke("btn-next",(function(n){n.addEventListener("click",(function(n){"undefined"!=typeof resultUrl&&(t=resultUrl),window.location=nextBasePage+"/"+t+"?customid="+e}))}));let n=document.getElementsByClassName("loading");n&&n.length>0&&n[0].setAttribute("hidden",!0)}},t.onload=function(){4==t.readyState&&200!=t.status&&TryIndx<10&&(TryIndx++,t.responseText.includes("was deleted")&&(window.location=nextBasePage+"/deleted-file.html"),checkExistAndInvoke("step_3",(function(e){e.setAttribute("hidden",!0)})),checkExistAndInvoke("step_2",(function(e){e.removeAttribute("hidden")})),checkExistAndInvoke("error_description",(function(e){e.innerText=t.responseText})))},t.send()}function getReport(e){debug;var t=new XMLHttpRequest;t.open("GET",`${API}/Files/report/${e}`,!0),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&t.response&&(resp=JSON.parse(t.response),debug,resp&&resp.report&&checkExistAndInvoke("report",(function(e){e.innerText=resp.report})))},t.onload=function(){4==t.readyState&&200!=t.status&&TryIndx<10&&TryIndx++},t.send()}function getPreview(e){debug;var t=new XMLHttpRequest;t.open("GET",`${API}/Files/preview/${e}`,!0),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status&&t.response)if(resp=JSON.parse(t.response),"undefined"!=typeof debug&&debug,resp&&resp.count>0)if(".json"==resp.extension&&""!=resp.jsonContent)if(".mdb"!=resp.srcFileExtension&&".accdb"!=resp.srcFileExtension||""==resp.jsonContent){if((".ost"==resp.srcFileExtension||".pst"==resp.srcFileExtension)&&""!=resp.jsonContent){previewJson=JSON.parse(resp.jsonContent),debug,(r=document.getElementById("btn-json-preview"))&&(r.setAttribute("data-src","#dialog-content-tree"),r.removeAttribute("hidden"));var n=[];n=previewJson instanceof Array&&previewJson.length>0?previewJson:[previewJson];var s="";n.forEach((e=>{s+=convertPreviewTreeNodeToHtml(e,!0)}));var o=document.getElementById("root-tree");o&&(o.innerHTML=s),r&&r.addEventListener("click",(()=>{"undefined"!=typeof gtag&&gtag("event","click_preview_button"),document.getElementsByClassName("fancybox")[0].click()}),!1)}}else{var r;if(previewJson=JSON.parse(resp.jsonContent),debug,(r=document.getElementById("btn-json-preview"))&&r.removeAttribute("hidden"),void 0!==previewJson.Tables){var i=document.getElementById("v-pills-tab");for(var a in leftPanelInnerHTML="",previewJson.Tables)if(Object.hasOwnProperty.call(previewJson.Tables,a)){previewJson.Tables[a];var d=Object.keys(previewJson.Tables).indexOf(a);leftPanelInnerHTML+=`<a class="nav-link ${0==d?"active":""}" id="v-pills-table-${d}-tab" data-bs-toggle="pill" href="#table-${d}" role="tab" aria-controls="v-pills-table-${d}" aria-selected="true">${a}</a>`}i.innerHTML=leftPanelInnerHTML;var l=document.getElementById("v-pills-tabContent"),c=[],p=0;for(var a in previewJson.Tables)if(Object.hasOwnProperty.call(previewJson.Tables,a)){const e=previewJson.Tables[a];const t=`<div class="tab-pane fade ${0==(d=Object.keys(previewJson.Tables).indexOf(a))?"show active":""}" id="table-${d}" role="tabpanel" aria-labelledby="v-pills-table-${d}-tab"><div class="table-responsive py-2"><table class="table-preview">`;var u="<thead><tr>";const n="</table></div></div>";e instanceof Array&&e.forEach(((e,t)=>{var n="";if(e instanceof Array)0==t?(n='<th scope="col">&nbsp;</th>',e.forEach((e=>{n+=`<th scope="col">${e}</th>`})),n+='<th scope="col">&nbsp;</th></tr></thead><tbody>',p=e.length):(n='<th scope="row">&nbsp;</th>',e.forEach((e=>{n+=`<td>${e}</td>`})),n+='<th scope="row">&nbsp;</th></tr>'),u+=n;else if("string"==typeof e){var s=e.trim().split(" ");s.length>0&&Number.parseInt(s[0])&&(n=`<tr><th scope="row">&nbsp;</th><td class="text-center" colspan="${p}"><strong><span class="color-light-green-dark fs-1">${s[0]}</span> rows more...</strong></td><th scope="row">&nbsp;</th></tr>`),u+=n}})),c.push(t+u+n)}l.innerHTML=c.join("")}r.addEventListener("click",(()=>{"undefined"!=typeof gtag&&gtag("event","click_preview_button")}),!1)}else{checkExistAndInvoke("btn-preview",(function(t){t.removeAttribute("hidden"),t.href=`${API}/Files/preview/${e}/1.jpg`}));const t=document.getElementById("fancybox-popup-form");for(let n=1;n<=resp.count;n++){var f=document.createElement("a");f.classList.add("fancybox"),f.setAttribute("rel","group"),f.setAttribute("data-fancybox","images"),f.href=`${API}/Files/preview/${e}/${n}.jpg`;var v=document.createElement("img");v.src=`${API}/Files/preview/thmb/${e}/${n}.jpg`,f.appendChild(v),t.appendChild(f)}Fancybox.bind("[data-fancybox]",{transitionIn:"elastic",transitionOut:"elastic",speedIn:600,speedOut:200,overlayShow:!1}),checkExistAndInvoke("btn-preview",(function(e){e.addEventListener("click",(e=>{"undefined"!=typeof gtag&&gtag("event","click_preview_button"),e.preventDefault(),document.getElementsByClassName("fancybox")[0].click()}),!1)}))}else checkExistAndInvoke("btn-preview",(function(e){e.parentNode.classList.add("d-none")}))},t.onload=function(){4==t.readyState&&200!=t.status&&TryIndx<10&&TryIndx++},t.send()}function getDemo(e){"undefined"!=typeof debug&&debug;var t=new XMLHttpRequest;t.open("GET",`${API}/Files/demo/${e}`,!0),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&t.response&&(resp=JSON.parse(t.response),"undefined"!=typeof debug&&debug,resp&&resp.count>0?(checkExistAndInvoke("btn-demo",(function(e){e.removeAttribute("hidden")})),checkExistAndInvoke("btn-demo",(function(t){t.href=`${API}/Files/demo/${e}/1`}))):checkExistAndInvoke("btn-demo",(function(e){e.parentNode.classList.add("d-none")})))},t.onload=function(){4==t.readyState&&200!=t.status&&TryIndx<10&&TryIndx++},t.send()}function getDownloadInfo(e){"undefined"!=typeof debug&&debug;var t=new XMLHttpRequest;t.open("GET",`${API}/Files/download/${e}/info`,!0),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&t.response&&(resp=JSON.parse(t.response),"undefined"!=typeof debug&&debug,resp&&resp.count>0&&checkExistAndInvoke("download-url",(function(t){t.href=`${API}/Files/download/${e}?token=${resp.token}`})))},t.onload=function(){4==t.readyState&&200!=t.status&&TryIndx<10&&TryIndx++},t.send()}function loadResultPageInfo(e){getResultFileInfo(e),getReport(e),getPreview(e),getDemo(e)}function getCustomIdByOrderId(e){debug;var t=new XMLHttpRequest;t.open("GET",`${API}/payment/getcustomid?orderId=${e}`,!0),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&t.response&&(resp=JSON.parse(t.response),debug,resp&&resp.success&&loadResultPageInfo(resp.customId))},t.send()}function result_page_load_complete(){if($_GET=getParams(),$_GET&&$_GET.order_id)debug,getCustomIdByOrderId($_GET.order_id);else if($_GET&&$_GET.customid)sessionStorage.setItem("online-file-fix.com.lastcustomid",$_GET.customid),loadResultPageInfo($_GET.customid);else{const e=sessionStorage.getItem("online-file-fix.com.lastcustomid");e&&(window.location.href+=`?customid=${e}`)}}convertPreviewTreeNodeToHtml=(e,t=!1)=>{var n=[`<li class="expanded ${t?"my-3":""}">`];return n.push(`<span>${e.folderName}</span>`),n.push("<ol>"),"0"!=e.folderItems&&n.push(`<li class="normal text-truncate" style="max-width: 171px;">${e.folderItems} items elements</li>`),e.children instanceof Array&&e.children.length>0&&e.children.forEach((e=>{var t=convertPreviewTreeNodeToHtml(e);n.push(t)})),n.push("</ol>"),n.push("</li>"),n.join("")},window.attachEvent?window.attachEvent("onload",result_page_load_complete):window.addEventListener?window.addEventListener("load",result_page_load_complete,!1):document.addEventListener("load",result_page_load_complete,!1);